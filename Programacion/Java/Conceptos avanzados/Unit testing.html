

<html>
    <head>
		<title>Java: Unit testing</title>
		<link rel="icon" type="image/x-icon" href="/favicon.ico">
        <link rel="stylesheet" href="../../../style.css">
    </head>

    <body>

    <h1 class="t1">Unit testing</h1>
	<div class="breadcrumb">
		<a href="../../../index.html">Mbascoy.dev</a> / 
		<a href="../index.html">Java</a> / 
		Unit testing
	</div>

    <div class="t2">Descripcion</div>
        <div class="cont">

            <p>Como implementar unit testing en <b>Java</b> utilizando <b>maven</b></p>

        </div>

    <div class="t2">Dependencia pom.xml</div>
        <div class="cont">

            <p>Para realizar los test usaremos <b>Junit</b>, asi que tenemos que incluir la siguiente dependencia en el <b>pom.xml</b>:</p>

            <pre><code id="htmlViewer" style="color:rgb(209, 217, 225); font-weight:400;background-color:rgb(71, 73, 73);background:rgb(71, 73, 73);display:block;padding: .5em;"><span style="color:rgb(209, 217, 225); font-weight:400;">&lt;<span style="color:rgb(181, 189, 104); font-weight:700;">dependency</span>&gt;</span>
  <span style="color:rgb(209, 217, 225); font-weight:400;">&lt;<span style="color:rgb(181, 189, 104); font-weight:700;">groupId</span>&gt;</span>junit<span style="color:rgb(209, 217, 225); font-weight:400;">&lt;/<span style="color:rgb(181, 189, 104); font-weight:700;">groupId</span>&gt;</span>
  <span style="color:rgb(209, 217, 225); font-weight:400;">&lt;<span style="color:rgb(181, 189, 104); font-weight:700;">artifactId</span>&gt;</span>junit<span style="color:rgb(209, 217, 225); font-weight:400;">&lt;/<span style="color:rgb(181, 189, 104); font-weight:700;">artifactId</span>&gt;</span>
  <span style="color:rgb(209, 217, 225); font-weight:400;">&lt;<span style="color:rgb(181, 189, 104); font-weight:700;">version</span>&gt;</span>4.11<span style="color:rgb(209, 217, 225); font-weight:400;">&lt;/<span style="color:rgb(181, 189, 104); font-weight:700;">version</span>&gt;</span>
  <span style="color:rgb(209, 217, 225); font-weight:400;">&lt;<span style="color:rgb(181, 189, 104); font-weight:700;">scope</span>&gt;</span>test<span style="color:rgb(209, 217, 225); font-weight:400;">&lt;/<span style="color:rgb(181, 189, 104); font-weight:700;">scope</span>&gt;</span>
<span style="color:rgb(209, 217, 225); font-weight:400;">&lt;/<span style="color:rgb(181, 189, 104); font-weight:700;">dependency</span>&gt;</span></code></pre>

            <p><b>NOTA</b>: En una aplicacion con <b>Spring</b> no necesitamos esta dependencia para los tests, ya que <b>Spring</b> tiene una dependencia propia para los tests.</p>

            <p><b>NOTA2</b>: Cuando creamos una aplicacion con <b>maven</b> por defecto ya se incluye esta dependencia en el <b>pom.xml</b></p>

            <p>AÑADIR ENLACE A TESTS DE SPRING</p>

        </div>

    <div class="t2">Metodo</div>
        <div class="cont">
          <p>Para implementar <b>Unit Test</b> en una aplicacion java creamos un archivo de test dentro de nuestra carpeta de tests, en nuestro caso seria:</p>

          <code>test/java/com/example</code>

          <img src="Unit testing/1.jpg"/>

          <p>En nuestro caso tenemos en nuestro codigo la siguiente funcion definida:</p>

          <pre><code id="htmlViewer" style="color:rgb(209, 217, 225); font-weight:400;background-color:rgb(71, 73, 73);background:rgb(71, 73, 73);display:block;padding: .5em;"><span style="color:rgb(204, 153, 204); font-weight:400;">package</span> com.example;

<span style="color:rgb(204, 153, 204); font-weight:400;">public</span> <span style="color:rgb(209, 217, 225); font-weight:400;"><span style="color:rgb(204, 153, 204); font-weight:400;">class</span> <span style="color:rgb(181, 189, 104); font-weight:400;">App</span>
</span>{
    <span style="color:rgb(209, 217, 225); font-weight:400;"><span style="color:rgb(204, 153, 204); font-weight:400;">public</span> <span style="color:rgb(204, 153, 204); font-weight:400;">static</span> <span style="color:rgb(204, 153, 204); font-weight:400;">void</span> <span style="color:rgb(181, 189, 104); font-weight:400;">main</span><span style="color:rgb(209, 217, 225); font-weight:400;">( String[] args )</span>
    </span>{
        System.out.println( sum(<span style="color:rgb(249, 145, 87); font-weight:400;">2</span>,<span style="color:rgb(249, 145, 87); font-weight:400;">3</span>));
    }

    <span style="color:rgb(209, 217, 225); font-weight:400;"><span style="color:rgb(204, 153, 204); font-weight:400;">public</span> <span style="color:rgb(204, 153, 204); font-weight:400;">static</span> <span style="color:rgb(204, 153, 204); font-weight:400;">int</span> <span style="color:rgb(181, 189, 104); font-weight:400;">sum</span><span style="color:rgb(209, 217, 225); font-weight:400;">(<span style="color:rgb(204, 153, 204); font-weight:400;">int</span> a, <span style="color:rgb(204, 153, 204); font-weight:400;">int</span> b)</span></span>{
        <span style="color:rgb(204, 153, 204); font-weight:400;">return</span> a + b;
    }
}
</code></pre>

          <p>Y en nuestros tests tenemos definido el siguiente codigo</p>

          <pre><code id="htmlViewer" style="color:rgb(209, 217, 225); font-weight:400;background-color:rgb(71, 73, 73);background:rgb(71, 73, 73);display:block;padding: .5em;"><span style="color:rgb(204, 153, 204); font-weight:400;">package</span> com.example;

<span style="color:rgb(204, 153, 204); font-weight:400;">import</span> <span style="color:rgb(204, 153, 204); font-weight:400;">static</span> org.junit.Assert.assertTrue;

<span style="color:rgb(204, 153, 204); font-weight:400;">import</span> org.junit.Test;

<span style="color:rgb(204, 153, 204); font-weight:400;">public</span> <span style="color:rgb(209, 217, 225); font-weight:400;"><span style="color:rgb(204, 153, 204); font-weight:400;">class</span> <span style="color:rgb(181, 189, 104); font-weight:400;">AppTest</span>
</span>{

    <span style="color:rgb(249, 145, 87); font-weight:400;">@Test</span>
    <span style="color:rgb(209, 217, 225); font-weight:400;"><span style="color:rgb(204, 153, 204); font-weight:400;">public</span> <span style="color:rgb(204, 153, 204); font-weight:400;">void</span> <span style="color:rgb(181, 189, 104); font-weight:400;">test_funcion_sum</span><span style="color:rgb(209, 217, 225); font-weight:400;">()</span>
    </span>{
        assertTrue( (App.sum(<span style="color:rgb(249, 145, 87); font-weight:400;">3</span>,<span style="color:rgb(249, 145, 87); font-weight:400;">2</span>) == <span style="color:rgb(249, 145, 87); font-weight:400;">5</span>));
    }
}
</code></pre>

          <p>En este ejemplo tenemos definida una funcion que suma dos numeros, la funcion <b>sum</b> y a mayores tenemos un test para probar dicha funcion <b>test_funcion_sum</b></p>

          <p>Los tests van precedidos por la anotacion <b>@Test</b>, en un archivo podemos tener varios tests, por ejemplo:</b>

          <pre><code id="htmlViewer" style="color:rgb(209, 217, 225); font-weight:400;background-color:rgb(71, 73, 73);background:rgb(71, 73, 73);display:block;padding: .5em;"><span style="color:rgb(249, 145, 87); font-weight:400;">@Test</span>
<span style="color:rgb(204, 153, 204); font-weight:400;">public</span> <span style="color:rgb(181, 189, 104); font-weight:400;">void</span> <span style="color:rgb(209, 217, 225); font-weight:400;"><span style="color:rgb(181, 189, 104); font-weight:400;">test_funcion_sum</span>(<span style="color:rgb(209, 217, 225); font-weight:400;"></span>)</span>
{
    assertTrue( (App.sum(<span style="color:rgb(249, 145, 87); font-weight:400;">3</span>,<span style="color:rgb(249, 145, 87); font-weight:400;">2</span>) == <span style="color:rgb(249, 145, 87); font-weight:400;">5</span>));
}

<span style="color:rgb(249, 145, 87); font-weight:400;">@Test</span>
<span style="color:rgb(204, 153, 204); font-weight:400;">public</span> <span style="color:rgb(181, 189, 104); font-weight:400;">void</span> <span style="color:rgb(209, 217, 225); font-weight:400;"><span style="color:rgb(181, 189, 104); font-weight:400;">test_funcion_sum_negative</span>(<span style="color:rgb(209, 217, 225); font-weight:400;"></span>)</span>
{
    assertTrue( (App.sum(-<span style="color:rgb(249, 145, 87); font-weight:400;">3</span>,<span style="color:rgb(249, 145, 87); font-weight:400;">2</span>) == -<span style="color:rgb(249, 145, 87); font-weight:400;">1</span>));
}</code></pre>


        </div>

    <div class="t2">Ejecucion de Tests</div>
        <div class="cont">
        <p>Cuando escribimos un test la primera vez que lo vayamos a ejecutar tenemos que lanzarlo con el comando <b>mvn test</b> (ya sea desde la consola o desde el IDE de Visual Code), esto se debe a que los tests primero se tienen que compilar, si intentamos ejecutarlos directamente desde el Visual Code, no se ejecutaran porque el archivo <b>.class</b> de los tests no esta creado</p>

        <img src="Unit testing/2.jpg"/>

        <p>Entonces, primero compilamos los tests con <b>mvn test</b>(esto ya los ejecutará directamente)</p>

        <p>y una vez esten compilados ya los podemos ejecutar directamente desde el visual code</p>

        <img src="Unit testing/3.jpg"/>

        <p>Aunque si queremos podemos ejecutarlos siempre usando el <b>mvn test</b>
        </div>


    <div class="t2">Unit Test SIN maven</div>
        <div class="cont">

          <p>Si queremos ejecutar los test en un project simple donde no tengamos <b>maven</b> podemos hacerlo de la siguientes maneras:</p>

          <h2>Desde VSCode</h2>

          <p>Para ejecutar los test sin <b>maven</b> desde <b>VScode</b> solo tenemos que añadir las siguientes librerías:</p>

          <ul>
            <li>junit-4.12.jar</li>
            <li>hamcrest-core-1.3.jar</li>
          </ul>


          <a href="../Conceptos basicos/VSCode classpath y librerias externas.html">Como añadir librerías externas en VSCode</a>

          <p>Si usamos versiones de liberías incompatibles se nos puede dar el siguiente error:</p>

          <code>java.lang.NoClassDefFoundError: org/hamcrest/SelfDescribing</code>

          <p>En mi caso era usando <b>junit-4.13.2.jar</b> y <b>hamcrest-core-2.2.jar</b>.</p>

          <p>Para ejcutar los test se hace usando la propia interfaz del <b>VSCode</b>:</p>

          <img src="Unit testing/3.jpg"/>

          <h2>Desde la consola</h2>

          <p>Partimos de una estructura de carpetas tal que así:</p>
          <p><b>NOTA:</b> es importante saber esto para poner en el <b>classpath</b> las rutas correctas.</p>

          <img src="Unit testing/4.png"/>

          <p>Primero tenemos que compilar la clase de <b>test</b>:</p>

          <code>javac -cp lib\junit-4.12.jar;src src\test\AppTest.java</code>

          <p>Despues ejecutamos los test con el siguiente comando:</p>

          <code>java -cp lib\junit-4.12.jar;lib\hamcrest-core-1.3.jar;src org.junit.runner.JUnitCore test.AppTest</code>

          <img src="Unit testing/5.png"/>

        </div>

    <div class="t2">Tags</div>
        <div class="cont">
        <p>Unit Test | maven | java</p>
        </div>

    </body>
</html>
