

<html>
    <head>
		<meta charset="utf-8"/>
		<title>MBascoy.dev: NFC Tags</title>
		<link rel="icon" type="image/x-icon" href="/favicon.ico">
        <link rel="stylesheet" href="../style.css">
    </head>

    <body>

    <h1 class="t1">NFC Tags</h1>
	<div class="breadcrumb">
		<a href="../index.html">Mbascoy.dev</a> / 
		NFC Tags
	</div>

    <div class="t2">Descripcion</div>
        <div class="cont">

            <p>Como utilizar <b>NFC Tags</b> usando un smartphone Android con NFC.</p>

            <p>Las tags que usaremos: <b>Mifare Classic 1k</b> (13,56Mhz ISO 14443 Tipo A)</p>

            <p>App: <b>MIFARE Classic Tool</b> - <a href="https://play.google.com/store/apps/details?id=de.syss.MifareClassicTool">Google Play</a></p>

            <p>Los tags Mifare Classic 1k los podemos comprar en Aliexpress en varios formatos: etiquetas, tarjetas, llaveros...</p>

            <p><b>NOTA:</b> Hay ciertos productos que están bajo el nombre <b>M1 S50 F08</b> estos tags son los mismos que Mifare Classic 1k</p>
            <img src="NFC Tags/14.png">
            <img src="NFC Tags/15.png">
            <img src="NFC Tags/16.png">

            <h2>Tipos de tags RFID</h2>
            <p>Existen varios tipos de tags RFID, los más comunes son:</p>
            <ul>
                <li>LF (Low Frecuency): 125 Khz (Chip de mascotas) (Hilo de cobre muy fino con muchas vueltas)</li>
                <img src="NFC Tags/17.png">

                <li>HF (High Frecuency): 13,56 Mhz (Mifare, NTAG213) (Pistas de aluminio/cobre rectangulares/circulares)</li>
                <p><b>(Este tipo es el que documentamos aquí)</b></p>
                <img src="NFC Tags/18.png">
                <img src="NFC Tags/19.png">
    
                <li>UHF (Ultra High Frecuency): 860 - 960 MHz (Etiquetas almacen/logística) (Líneas raras, largas y asimétricas (como un grafiti))</li>
                <img src="NFC Tags/20.png">

            </ul>

            <p><b>NOTA:</b> No confundir módulos <b>RFID</b> con módulos <b>RF</b>, los primeros suelen ser módulos pásivos y los segundos módulos activos (Como mandos de garajes)</p>
        </div>

    <div class="t2">Consultar tag info</div>
        <div class="cont">
            <p>Primero vamos a consultar la información del tag que tengamos, para verificar que es exactamente un <b>Mifare Classic 1k</b></p>

            <p>Nos vamos a <b>Herramientas</b> &gt; <b>Mostrar información de la etiqueta</b></p>
            <img src="NFC Tags/5.png">

            <p>Acercamos el tag al NFC del smartphone y se mostrará la información del tag:</p>
            <img src="NFC Tags/6.png">

        </div>

    <div class="t2">Leer Tags</div>
        <div class="cont">
            <p>Para leer el contenido de una tag entramos en <b>"LEER ETIQUETA"</b></p>

            <img src="NFC Tags/1.png">

            <p>Una vez dentro, <b>acercamos el tag</b> al smartphone, nos saldrá un mensaje indicando el UID del tag</p>
            <img src="NFC Tags/2.png">

            <p>Le damos a <b>"COMENZAR MAPEO Y LEER ETIQUETA"</b></p>

            <p><b>NOTA:</b> En este paso es importante <b>MANTENER el tag pegado al smartphone</b>, no vale con que se escanee y despues separarlo, hay que mantenerlo pegado todo el tiempo.</p>
            <img src="NFC Tags/3.png">

            <p>Una vez finalizado el proceso nos mostrará un resumen del contenido leido:</p>
            <img src="NFC Tags/4.png">

            <p>Una vez leido el contenido, podemos pulsar en los 3 puntos arriba a la derecha para guardar la información para usarla posteriormente.</p>

            <p>Las lecturas que hayamos guardado las podemos editar desde <b>"EDITAR/ANALIZAR DUMPEO"</b></p>
            <img src="NFC Tags/7.png">

        </div>

    <div class="t2">Escribir Tags</div>
        <div class="cont">
            <p>Una vez hayamos leido y guardado el contenido de un tag podemos editarlo y escribirlo en un nuevo tag (o el mismo si solo queremos editar el tag)</p>

            <p>Nos vamos a <b>"ESCRIBIR ETIQUETA"</b> y despues seleccionamos <b>Write Dump (Clone)</b></p>
            <img src="NFC Tags/8.png">

            <p>Le damos a <b>"SELECCIONAR DUMPEO"</b>, y seleccionamos el archivo <b>.mct</b> que queramos escribir en el tag</p>

            <p>Despues nos saldrá una lista de los sectores que queremos grabar, normalmente seleccionaremos todos y le damos a <b>ACEPTAR</b>:</p>

            <p><b>NOTA:</b> En este momento (antes de pulsar ACEPTAR), tenemos que mantener el tag pegado el smartphone, debemos mantenerlo pegado todo el rato hasta que se complete la escritura.</p>
            <img src="NFC Tags/9.png">

            <p>En la siguiente pantalla solo tenemos que pulsar <b>"COMENZAR MAPEO Y ESCRIBIR DUMPEO"</b>, (en este momento debemos de seguir manteniendo el tag pegado al smartphone)</p>
            <img src="NFC Tags/10.png">

            <p>Una vez finalizada la escritura se mostrará un mensaje indicando que los datos se han guardado exitosamente:</p>
            <img src="NFC Tags/11.png">

        </div>

    <div class="t2">Modificar UID (Escribir Sector 0)</div>
        <div class="cont">
            <p>Modificar el UID de una tag <b>Mifare Classic 1k</b> es un proceso un poco más complejo, ya que el UID se encuentra en el Sector 0, y este sector tiene protecciones especiales.</p>

            <p>Necesitamos un tag (el tag físico) que permita realizar la escritura en el Sector 0, En Aliexpress podemos encontrar etiquetas llamadas <b>"Magic tag Gen 2"</b> que permiten realizar esta modificación, tambien se pueden encontrar con el nombre <b>CUID</b> (Changeable UID).</p>

            <p>En la App para modificar el UID lo hacemos desde <b>ESCRIBIR ETIQUETA</b> &gt; <b>Clone UID</b>, si nuestro tag no permite realizar modificaciones del UID obtendremos un error como el siguiente:</p>
            <img src="NFC Tags/12.png">

            <p>Cuando tenemos un tag <b>Gen 2</b> que permite escribir en el sector 0 la salida es la siguiente:</p>
            <img src="NFC Tags/21.png">

            <p><b>NOTA:</b> los tags "Magic tag Gen 2" no permiten modificar el sexto byte del sector 0, este byte marca el tipo de tarjeta, aunque no podamos modificar este byte no quiere decir que la clonación no vaya a funcionar, aunque puede ser que no funcione, tendremos que probar con el lector original para asegurarnos.</p>

            <h3>Tags con UID de 7 bytes</h3>

            <p>Hay tags que tienen un UID de 7 bytes, si intentamos clonar estos tags aunque tengamos un <b>"Magic tag Gen 2"</b> no funcionará, porque el funcionamiento interno de estas tarjetas es un poco distinto, si queremos clonar estas tarjetas necesitaremos tags con UID de 7 bytes normalmente se llaman <b>Magic tag 7 bytes gen3</b> (son algo más dificiles de encontrar que las GEN2), y no las podremos escribir usando el NFC de un smartphone, necesitaremos un lector específico como el <b>ACR122U-A9</b>:</p>
            <img src="NFC Tags/22.png">

            <h3>Diferenciar tags de 4 bytes y tags de 7 bytes</h3>

            <p>Normalmente al leer un tag si nos vamos a <b>Herramientas</b> &gt; <b>Mostrar información de la etiqueta</b> nos indica que tipo de UID tiene el tag:</p>
            <img src="NFC Tags/23.png">

            <p>Pero un truco que tambien podemos utilizar es verificar si el 5 byte del bloque 0 es el byte de verificación, en los tags con UID de 4 bytes este byte es una operación <b>XOR</b> de los 4 bytes anteriores, los tags con UID de 7 bytes no tienen el byte de verificación almacenado (en verdad lo calculan al vuelo durante la comunicación con el lector):</p>

            <p>En este ejemplo nuestro UID es <b>2B08C871</b>, si hacemos una operación XOR de estos 4 bytes obtendremos <b>9A</b> que es el quinto byte, de este modo sabremos que este tag es un tag con UID de 4 bytes:</p>
            <img src="NFC Tags/24.png">

        </div>

    <div class="t2">Troubleshooting</div>
        <div class="cont">
            <h3>Error: No hay una etiqueta MIFARE Classic</h3>
            <img src="NFC Tags/13.png">

            <p>Si obtenemos este error al leer o al escribir un tag normalmente es porque el tag no está cerca del NFC del smartphone, al leer o escribir un tag es importante que debemos <b>mantener el tag completamente pegado al NFC</b> del smartphone durante todo el rato.</p>
        </div>

    <div class="t2">Tags</div>
        <div class="cont">
            <p>NFC | Mifare | RFID </p>
        </div>

    </body>
</html>
